Delectus 1.0 activation mechanism

When Delectus starts up, it reads an activation object from the path
  Delectus.app/Contents/Resources/activation.rec

The file activation.rec contains a JSON object like this:

  {
    username: "John Smith";
    date: "2010-05-23";
    key: "<a-GUID>"
  }

The JSON data is written in UTF-8, then encoded with a symmetric hash function. Delectus decrypts the data to retrieve the original data, and tests whether it constitutes a valid activation record. If so, it runs the application. If not, it poses a message explaining the reason for the test's failure, then quits.

A record may be valid in one of two ways:

1. It may contain a trial key. Delectus ships with a set of trial keys embedded in its code. A trial key authorizes Delectus to run for thirty days after its first launch, the date recorded in the activation.rec. After thirty days have passed, the activation record is no longer valid. The user must obtain a paid activation record or stop using the software, and Delectus poses a dialog to that effect.

2. It may contain a paid key. A paid key never expires. Delectus does not carry paid keys embedded. Instead, it must check a paid key by querying the bywicket database. Four responses are possible:

  - valid: run Delectus
  - expired: warn the user about the expired key, then run Delectus
  - invalid: explain that the key is invalid, then quit
  - unavailable: run Delectus (if no contact with the server is available, Delectus will try again later)

Only the "invalid" response disables Delectus.

The bywicket Delectus server provides:

  - a database of serial numbers that have been dispensed, with billing info for each purchaser
  - a web service that Delectus can use to look up a serial number and take appropriate action based on the response
  - a billing API (likely Google Checkout) for purchasing serial numbers

