= Delectus 2 Tables
:toc:

== 'delectus'

The `delectus` table stores data identifying the file, the list, and the Delectus node that created them. It also records the version of the file format used, and if the new list was created by *compacting* an existing *parent* list, then it records the `identity` of the parent.

[cols="1,2,4",options="header"]
.Structure of the `delectus` table
|===
| column | type | description
| `listid` | `identity`  | The unique identity of this list
| `fileid` | `identity`  | The unique identity of this list file
| `origin` | `identity`  | The unique identity of the Delectus node that created this list file
| `parent` | `identity` or `NULL`  | The unique identity of the Delectus list file from which this file was derived by a *compaction*
| `format` | `TEXT`  | The version of the Delectus file format in this list file
| `next_revision` | `integer`  | The revision number that will be assigned to the next op inserted in any of the other tables.
|===

== 'listnames'

The `'listnames'` table records `listname` ops, which set the name of the list. The current name of the list is the value of the `name` field of the latest row of the `listnames` table.

[cols="1,2,4",options="header"]
.Structure of the `listnames` table
|===
| field | type | description
| `opid` | `identity` | Uniquely identifies the `'listname'` op.
| `revision` | `integer` | The revision count of the file when this op was inserted.
| `origin` | `identity` | Uniquely identifies the node that created the op.
| `timestamp` | `timestamp` | The time that the op was created, as reported by the creating node.
| `name` | `TEXT` | The new name of the list.
|===

== 'columns'

The `'columns'` table records `'columns'` ops, which specify the identities and attributes of *userdata* columns.

[cols="1,2,4",options="header"]
.Structure of the `'columns'` table
|===
| field | type | description
| `opid` | `identity` | Uniquely identifies the `'listname'` op.
| `revision` | `integer` | The revision count of the file when this op was inserted.
| `origin` | `identity` | Uniquely identifies the node that created the op.
| `timestamp` | `timestamp` | The time that the op was created, as reported by the creating node.
| `_[label]_+` | `identity` | A `column` object defining the attributes of the column.
|===

The notation `_[label]_+` represents one or more column labels, each of which is an `identity` string. There may be any number of columns, each created by the user, and each with its own _label_. The contents of each column in the `'columns'` table is a JSON object that gives the attributes of the column.

The `'columns'` and `'item'` tables must have the same `_[label]_+` columns.

== 'items'

[cols="1,2,4",options="header"]
.Structure of the `'columns'` table
|===
| field | type | description
| `opid` | `identity` | Uniquely identifies the `'listname'` op.
| `revision` | `integer` | The revision count of the file when this op was inserted.
| `origin` | `identity` | Uniquely identifies the node that created the op.
| `timestamp` | `identity` | The time that the op was created, as reported by the creating node.
| `item` | `identity` | Uniquely identifies the item that this op represents.
| `deleted` | `Boolean` | Whether this item is marked deleted.
| `_[label]_+` | JSON `null`, `Boolean`, `number`, or `string` | A JSON value.
|===

The notation `_[label]_+` represents one or more column labels, each of which is an `identity` string. There may be any number of columns, each created by the user, and each with its own _label_. The contents of each column in the `'items'` table is a JSON object that gives the value of the column in the item.

The `'columns'` and `'items'` tables must have the same `_[label]_+` columns.
